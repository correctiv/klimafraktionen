<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Klimafraktionen</title>
  <link rel="stylesheet" href="../style.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
  <script src="https://cdn.polyfill.io/v1/polyfill.min.js?features=Intl.~locale.de,Intl.~locale.en,Intl.~locale.fr"></script>
  <script src="../chart.js"></script>
</head>
<body>

  <div class="climate-factions">
    <div class="climate-factions__button-group">
      <button class="climate-factions__button climate-factions__button--a" data-action-focus="A">Die Einflussreichen</button>
      <button class="climate-factions__button climate-factions__button--b" data-action-focus="B">Die Blockierer</button>
      <button class="climate-factions__button climate-factions__button--c" data-action-focus="C">Die Aufsteiger</button>
      <button class="climate-factions__button climate-factions__button--d" data-action-focus="D">Die Schwachen</button>
      <button class="climate-factions__button" data-action-reset=>alle anzeigen</button>
    </div>

    <div id="chart"></div>
  </div>

  <script>

    var chart = new ClimateChart('#chart', {
      path: 'data/climate-data.csv',
      locale: 'de',
      xAxisDivisor: 1000000000,
      xAxisDescription: 'Bruttoinlandsprodukt (in Mrd. US-Dollar)',
      yAxisDescription: 'CO2-Ausstoß (Tonnen pro Kopf)',
      threshold: 2.48,
      thresholdDescription: '2,48 t/Kopf',
      locale: 'de',
      tooltipData: {
        'co2_t_pc_2012': 'CO2-Ausstoß (in t/Kopf)',
        'gdp_2014': 'BIP 2014 (in US-Dollar)',
        'population_2014': 'Bevölkerung 2014',
        'population_2050': 'Bevölkerung 2050',
        'climate_change_performance_index': 'Platz im Klimaschutz-Index'
      }
    });

    var focusButtons = document.querySelectorAll('[data-action-focus]');
    var resetButton = document.querySelector('[data-action-reset]');

    resetButton.addEventListener('click', function() {
      chart.reset();
      Array.prototype.forEach.call(focusButtons, function(button){
        if (button.classList) {
          button.classList.remove('climate-factions__button--inactive');
          button.classList.remove('climate-factions__button--active');
        }
      });
    });

    Array.prototype.forEach.call(focusButtons, function(button){
      button.addEventListener('click', function() {
        var focusTarget = button.getAttribute('data-action-focus');
        chart.focusGroup(focusTarget);
        if (button.classList) {
          Array.prototype.forEach.call(focusButtons, function(button){
            button.classList.add('climate-factions__button--inactive');
          });
          button.classList.remove('climate-factions__button--inactive');
          button.classList.add('climate-factions__button--active');
        }
      });
    });
  </script>
</body>
</html>
